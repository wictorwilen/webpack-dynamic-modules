# Demonstration of dynamic module loading using Webpack and System.js

This is a demo that uses Webpack to bundle libraries and modules and System.js to dynamically load the modules, 
including external modules from CDN.

# DEMO

## Project: core

Contains the basic setup to create the library as well as two external modules (`WidgetA` and `WidgetB`)

### Usage

Run the following (you need node.js, webpack, npm, gulp and typings installed)
```
cd core
npm init
typings init
gulp serve
```

Then browse to [http://localhost:1337/](http://localhost:1337/)

### Verification

Expected output in browser console is. Widgets are loaded from an array in `main.ts`.
```  
* Rendering Widget A
* Widget A
* Rendering Widget B
* Widget B
* Widget loading error...
```

And the background should be pink and foreground navy blue.

### Additional commands

Run the following to just build (copies .html to `./dist` and runs webpack) it:

```
gulp
```

Run the following to just start the web server

```
node server.js
```

## Project: external-module

The *external-module* project contains an "external" widget using the library
created in the *core* project. It has a copy of the `webpack-dynamic-modules.d.ts` file in
the typings project (that file is generated by the `gulp dts` task in *core*).

The `ExternaLWidget.ts` references the `webpack-dynamic-modules.d.ts` file and uses
Webpack to create the bundle.

### Test with external module

Copy the generated `ExternalWidget.js` to the `dist` folder of the *core* project and 
run `gulp serve` to test it all. You should see the following in the browser console:

```  
* Rendering Widget A
* Widget A
* Rendering Widget B
* Widget B
* External Widget is here!
```

# How to set this up

These are the individual steps needed to make this possible

## index.html

* Reference `system.js` from a CDN first and then import your main file.

## main.ts

* Your main file can contain `System.config({})` stuff if necessary.
* Do **not** add the `import * as SystemJS from 'systemjs'` at all, that will totally break everything.
* If you have used *requirejs*  previously, note that you **must** use the `.js` file extension when importing.

## Typings

The following Typings are required:

* systemjs
* es6-promise
* *libraries of your choice*

## Webpack configuration

* Set `targetLibrary` to `commonjs`
* External mappings should point locally or to CDN locations. SystemJS will pick this up and load them properly.
* You need to use the `CommonsChunkPlugin` and point it to your main library

## Typescript configuration

In your `tsconfig.json` file make sure to set `module` to `commonjs`.

# Feedback

Please submit any feedback as issues or pull requests!

# Warranty

None whatsoever - works on my machine....